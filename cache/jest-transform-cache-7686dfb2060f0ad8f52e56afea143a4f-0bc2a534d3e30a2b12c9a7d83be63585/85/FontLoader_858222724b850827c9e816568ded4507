228896edbf7d160d906b4d93abdf5e52
var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");
Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.fontFamilyNeedsScoping = fontFamilyNeedsScoping;
exports.getAssetForSource = getAssetForSource;
exports.getNativeFontName = getNativeFontName;
exports.loadSingleFontAsync = loadSingleFontAsync;
var _asyncToGenerator2 = _interopRequireDefault(require("@babel/runtime/helpers/asyncToGenerator"));
var _expoAsset = require("expo-asset");
var _expoConstants = _interopRequireDefault(require("expo-constants"));
var _expoModulesCore = require("expo-modules-core");
var _reactNative = require("react-native");
var _ExpoFontLoader = _interopRequireDefault(require("./ExpoFontLoader"));
var isInClient = _expoConstants.default.appOwnership === 'expo';
var isInIOSStandalone = _expoConstants.default.appOwnership === 'standalone' && _reactNative.Platform.OS === 'ios';
function fontFamilyNeedsScoping(name) {
  return (isInClient || isInIOSStandalone) && !_expoConstants.default.systemFonts.includes(name) && name !== 'System' && !name.includes(_expoConstants.default.sessionId);
}
function getAssetForSource(source) {
  if (source instanceof _expoAsset.Asset) {
    return source;
  }
  if (typeof source === 'string') {
    return _expoAsset.Asset.fromURI(source);
  } else if (typeof source === 'number') {
    return _expoAsset.Asset.fromModule(source);
  } else if (typeof source === 'object' && typeof source.uri !== 'undefined') {
    return getAssetForSource(source.uri);
  }
  return source;
}
function loadSingleFontAsync(_x, _x2) {
  return _loadSingleFontAsync.apply(this, arguments);
}
function _loadSingleFontAsync() {
  _loadSingleFontAsync = (0, _asyncToGenerator2.default)(function* (name, input) {
    var asset = input;
    if (!asset.downloadAsync) {
      throw new _expoModulesCore.CodedError(`ERR_FONT_SOURCE`, '`loadSingleFontAsync` expected resource of type `Asset` from expo-asset on native');
    }
    yield asset.downloadAsync();
    if (!asset.downloaded) {
      throw new _expoModulesCore.CodedError(`ERR_DOWNLOAD`, `Failed to download asset for font "${name}"`);
    }
    yield _ExpoFontLoader.default.loadAsync(getNativeFontName(name), asset.localUri);
  });
  return _loadSingleFontAsync.apply(this, arguments);
}
function getNativeFontName(name) {
  if (fontFamilyNeedsScoping(name)) {
    return `${_expoConstants.default.sessionId}-${name}`;
  } else {
    return name;
  }
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfZXhwb0Fzc2V0IiwicmVxdWlyZSIsIl9leHBvQ29uc3RhbnRzIiwiX2ludGVyb3BSZXF1aXJlRGVmYXVsdCIsIl9leHBvTW9kdWxlc0NvcmUiLCJfcmVhY3ROYXRpdmUiLCJfRXhwb0ZvbnRMb2FkZXIiLCJpc0luQ2xpZW50IiwiQ29uc3RhbnRzIiwiYXBwT3duZXJzaGlwIiwiaXNJbklPU1N0YW5kYWxvbmUiLCJQbGF0Zm9ybSIsIk9TIiwiZm9udEZhbWlseU5lZWRzU2NvcGluZyIsIm5hbWUiLCJzeXN0ZW1Gb250cyIsImluY2x1ZGVzIiwic2Vzc2lvbklkIiwiZ2V0QXNzZXRGb3JTb3VyY2UiLCJzb3VyY2UiLCJBc3NldCIsImZyb21VUkkiLCJmcm9tTW9kdWxlIiwidXJpIiwibG9hZFNpbmdsZUZvbnRBc3luYyIsIl94IiwiX3gyIiwiX2xvYWRTaW5nbGVGb250QXN5bmMiLCJhcHBseSIsImFyZ3VtZW50cyIsIl9hc3luY1RvR2VuZXJhdG9yMiIsImRlZmF1bHQiLCJpbnB1dCIsImFzc2V0IiwiZG93bmxvYWRBc3luYyIsIkNvZGVkRXJyb3IiLCJkb3dubG9hZGVkIiwiRXhwb0ZvbnRMb2FkZXIiLCJsb2FkQXN5bmMiLCJnZXROYXRpdmVGb250TmFtZSIsImxvY2FsVXJpIl0sInNvdXJjZXMiOlsiLi4vc3JjL0ZvbnRMb2FkZXIudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQXNzZXQgfSBmcm9tICdleHBvLWFzc2V0JztcbmltcG9ydCBDb25zdGFudHMgZnJvbSAnZXhwby1jb25zdGFudHMnO1xuaW1wb3J0IHsgQ29kZWRFcnJvciB9IGZyb20gJ2V4cG8tbW9kdWxlcy1jb3JlJztcbmltcG9ydCB7IFBsYXRmb3JtIH0gZnJvbSAncmVhY3QtbmF0aXZlJztcblxuaW1wb3J0IEV4cG9Gb250TG9hZGVyIGZyb20gJy4vRXhwb0ZvbnRMb2FkZXInO1xuaW1wb3J0IHsgRm9udFJlc291cmNlLCBGb250U291cmNlIH0gZnJvbSAnLi9Gb250LnR5cGVzJztcblxuY29uc3QgaXNJbkNsaWVudCA9IENvbnN0YW50cy5hcHBPd25lcnNoaXAgPT09ICdleHBvJztcbmNvbnN0IGlzSW5JT1NTdGFuZGFsb25lID0gQ29uc3RhbnRzLmFwcE93bmVyc2hpcCA9PT0gJ3N0YW5kYWxvbmUnICYmIFBsYXRmb3JtLk9TID09PSAnaW9zJztcblxuZXhwb3J0IGZ1bmN0aW9uIGZvbnRGYW1pbHlOZWVkc1Njb3BpbmcobmFtZTogc3RyaW5nKTogYm9vbGVhbiB7XG4gIHJldHVybiAoXG4gICAgKGlzSW5DbGllbnQgfHwgaXNJbklPU1N0YW5kYWxvbmUpICYmXG4gICAgIUNvbnN0YW50cy5zeXN0ZW1Gb250cy5pbmNsdWRlcyhuYW1lKSAmJlxuICAgIG5hbWUgIT09ICdTeXN0ZW0nICYmXG4gICAgIW5hbWUuaW5jbHVkZXMoQ29uc3RhbnRzLnNlc3Npb25JZClcbiAgKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldEFzc2V0Rm9yU291cmNlKHNvdXJjZTogRm9udFNvdXJjZSk6IEFzc2V0IHwgRm9udFJlc291cmNlIHtcbiAgaWYgKHNvdXJjZSBpbnN0YW5jZW9mIEFzc2V0KSB7XG4gICAgcmV0dXJuIHNvdXJjZTtcbiAgfVxuXG4gIGlmICh0eXBlb2Ygc291cmNlID09PSAnc3RyaW5nJykge1xuICAgIHJldHVybiBBc3NldC5mcm9tVVJJKHNvdXJjZSk7XG4gIH0gZWxzZSBpZiAodHlwZW9mIHNvdXJjZSA9PT0gJ251bWJlcicpIHtcbiAgICByZXR1cm4gQXNzZXQuZnJvbU1vZHVsZShzb3VyY2UpO1xuICB9IGVsc2UgaWYgKHR5cGVvZiBzb3VyY2UgPT09ICdvYmplY3QnICYmIHR5cGVvZiBzb3VyY2UudXJpICE9PSAndW5kZWZpbmVkJykge1xuICAgIHJldHVybiBnZXRBc3NldEZvclNvdXJjZShzb3VyY2UudXJpKTtcbiAgfVxuXG4gIC8vIEB0cy1pZ25vcmUgRXJyb3I6IFR5cGUgJ3N0cmluZycgaXMgbm90IGFzc2lnbmFibGUgdG8gdHlwZSAnQXNzZXQnXG4gIC8vIFdlIGNhbid0IGhhdmUgYSBzdHJpbmcgaGVyZSwgd2Ugd291bGQgaGF2ZSB0aHJvd24gYW4gZXJyb3IgaWYgIWlzV2ViXG4gIC8vIG9yIHJldHVybmVkIEFzc2V0LmZyb21Nb2R1bGUgaWYgaXNXZWIuXG4gIHJldHVybiBzb3VyY2U7XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBsb2FkU2luZ2xlRm9udEFzeW5jKFxuICBuYW1lOiBzdHJpbmcsXG4gIGlucHV0OiBBc3NldCB8IEZvbnRSZXNvdXJjZVxuKTogUHJvbWlzZTx2b2lkPiB7XG4gIGNvbnN0IGFzc2V0ID0gaW5wdXQgYXMgQXNzZXQ7XG4gIGlmICghYXNzZXQuZG93bmxvYWRBc3luYykge1xuICAgIHRocm93IG5ldyBDb2RlZEVycm9yKFxuICAgICAgYEVSUl9GT05UX1NPVVJDRWAsXG4gICAgICAnYGxvYWRTaW5nbGVGb250QXN5bmNgIGV4cGVjdGVkIHJlc291cmNlIG9mIHR5cGUgYEFzc2V0YCBmcm9tIGV4cG8tYXNzZXQgb24gbmF0aXZlJ1xuICAgICk7XG4gIH1cblxuICBhd2FpdCBhc3NldC5kb3dubG9hZEFzeW5jKCk7XG4gIGlmICghYXNzZXQuZG93bmxvYWRlZCkge1xuICAgIHRocm93IG5ldyBDb2RlZEVycm9yKGBFUlJfRE9XTkxPQURgLCBgRmFpbGVkIHRvIGRvd25sb2FkIGFzc2V0IGZvciBmb250IFwiJHtuYW1lfVwiYCk7XG4gIH1cbiAgYXdhaXQgRXhwb0ZvbnRMb2FkZXIubG9hZEFzeW5jKGdldE5hdGl2ZUZvbnROYW1lKG5hbWUpLCBhc3NldC5sb2NhbFVyaSk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXROYXRpdmVGb250TmFtZShuYW1lOiBzdHJpbmcpOiBzdHJpbmcge1xuICBpZiAoZm9udEZhbWlseU5lZWRzU2NvcGluZyhuYW1lKSkge1xuICAgIHJldHVybiBgJHtDb25zdGFudHMuc2Vzc2lvbklkfS0ke25hbWV9YDtcbiAgfSBlbHNlIHtcbiAgICByZXR1cm4gbmFtZTtcbiAgfVxufVxuIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7QUFBQSxJQUFBQSxVQUFBLEdBQUFDLE9BQUE7QUFDQSxJQUFBQyxjQUFBLEdBQUFDLHNCQUFBLENBQUFGLE9BQUE7QUFDQSxJQUFBRyxnQkFBQSxHQUFBSCxPQUFBO0FBQ0EsSUFBQUksWUFBQSxHQUFBSixPQUFBO0FBRUEsSUFBQUssZUFBQSxHQUFBSCxzQkFBQSxDQUFBRixPQUFBO0FBR0EsSUFBTU0sVUFBVSxHQUFHQyxzQkFBUyxDQUFDQyxZQUFZLEtBQUssTUFBTTtBQUNwRCxJQUFNQyxpQkFBaUIsR0FBR0Ysc0JBQVMsQ0FBQ0MsWUFBWSxLQUFLLFlBQVksSUFBSUUscUJBQVEsQ0FBQ0MsRUFBRSxLQUFLLEtBQUs7QUFFcEYsU0FBVUMsc0JBQXNCQSxDQUFDQyxJQUFZO0VBQ2pELE9BQ0UsQ0FBQ1AsVUFBVSxJQUFJRyxpQkFBaUIsS0FDaEMsQ0FBQ0Ysc0JBQVMsQ0FBQ08sV0FBVyxDQUFDQyxRQUFRLENBQUNGLElBQUksQ0FBQyxJQUNyQ0EsSUFBSSxLQUFLLFFBQVEsSUFDakIsQ0FBQ0EsSUFBSSxDQUFDRSxRQUFRLENBQUNSLHNCQUFTLENBQUNTLFNBQVMsQ0FBQztBQUV2QztBQUVNLFNBQVVDLGlCQUFpQkEsQ0FBQ0MsTUFBa0I7RUFDbEQsSUFBSUEsTUFBTSxZQUFZQyxnQkFBSyxFQUFFO0lBQzNCLE9BQU9ELE1BQU07O0VBR2YsSUFBSSxPQUFPQSxNQUFNLEtBQUssUUFBUSxFQUFFO0lBQzlCLE9BQU9DLGdCQUFLLENBQUNDLE9BQU8sQ0FBQ0YsTUFBTSxDQUFDO0dBQzdCLE1BQU0sSUFBSSxPQUFPQSxNQUFNLEtBQUssUUFBUSxFQUFFO0lBQ3JDLE9BQU9DLGdCQUFLLENBQUNFLFVBQVUsQ0FBQ0gsTUFBTSxDQUFDO0dBQ2hDLE1BQU0sSUFBSSxPQUFPQSxNQUFNLEtBQUssUUFBUSxJQUFJLE9BQU9BLE1BQU0sQ0FBQ0ksR0FBRyxLQUFLLFdBQVcsRUFBRTtJQUMxRSxPQUFPTCxpQkFBaUIsQ0FBQ0MsTUFBTSxDQUFDSSxHQUFHLENBQUM7O0VBTXRDLE9BQU9KLE1BQU07QUFDZjtBQUFDLFNBRXFCSyxtQkFBbUJBLENBQUFDLEVBQUEsRUFBQUMsR0FBQTtFQUFBLE9BQUFDLG9CQUFBLENBQUFDLEtBQUEsT0FBQUMsU0FBQTtBQUFBO0FBQUEsU0FBQUYscUJBQUE7RUFBQUEsb0JBQUEsT0FBQUcsa0JBQUEsQ0FBQUMsT0FBQSxFQUFsQyxXQUNMakIsSUFBWSxFQUNaa0IsS0FBMkI7SUFFM0IsSUFBTUMsS0FBSyxHQUFHRCxLQUFjO0lBQzVCLElBQUksQ0FBQ0MsS0FBSyxDQUFDQyxhQUFhLEVBQUU7TUFDeEIsTUFBTSxJQUFJQywyQkFBVSxDQUNsQixpQkFBaUIsRUFDakIsbUZBQW1GLENBQ3BGOztJQUdILE1BQU1GLEtBQUssQ0FBQ0MsYUFBYSxFQUFFO0lBQzNCLElBQUksQ0FBQ0QsS0FBSyxDQUFDRyxVQUFVLEVBQUU7TUFDckIsTUFBTSxJQUFJRCwyQkFBVSxDQUFDLGNBQWMsRUFBRSxzQ0FBc0NyQixJQUFJLEdBQUcsQ0FBQzs7SUFFckYsTUFBTXVCLHVCQUFjLENBQUNDLFNBQVMsQ0FBQ0MsaUJBQWlCLENBQUN6QixJQUFJLENBQUMsRUFBRW1CLEtBQUssQ0FBQ08sUUFBUSxDQUFDO0VBQ3pFLENBQUM7RUFBQSxPQUFBYixvQkFBQSxDQUFBQyxLQUFBLE9BQUFDLFNBQUE7QUFBQTtBQUVLLFNBQVVVLGlCQUFpQkEsQ0FBQ3pCLElBQVk7RUFDNUMsSUFBSUQsc0JBQXNCLENBQUNDLElBQUksQ0FBQyxFQUFFO0lBQ2hDLE9BQU8sR0FBR04sc0JBQVMsQ0FBQ1MsU0FBUyxJQUFJSCxJQUFJLEVBQUU7R0FDeEMsTUFBTTtJQUNMLE9BQU9BLElBQUk7O0FBRWYifQ==