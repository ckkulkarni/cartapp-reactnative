a3357c25791fa3e4a4e114598ce6ee81
var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");
Object.defineProperty(exports, "__esModule", {
  value: true
});
Object.defineProperty(exports, "FontDisplay", {
  enumerable: true,
  get: function get() {
    return _Font.FontDisplay;
  }
});
exports.isLoaded = isLoaded;
exports.isLoading = isLoading;
exports.loadAsync = loadAsync;
exports.processFontFamily = processFontFamily;
exports.unloadAllAsync = unloadAllAsync;
exports.unloadAsync = unloadAsync;
var _asyncToGenerator2 = _interopRequireDefault(require("@babel/runtime/helpers/asyncToGenerator"));
var _expoModulesCore = require("expo-modules-core");
var _ExpoFontLoader = _interopRequireDefault(require("./ExpoFontLoader"));
var _Font = require("./Font.types");
var _FontLoader = require("./FontLoader");
var loaded = {};
var loadPromises = {};
function processFontFamily(fontFamily) {
  if (!fontFamily || !(0, _FontLoader.fontFamilyNeedsScoping)(fontFamily)) {
    return fontFamily;
  }
  if (!isLoaded(fontFamily)) {
    if (__DEV__) {
      if (isLoading(fontFamily)) {
        console.error(`You started loading the font "${fontFamily}", but used it before it finished loading. You need to wait for Font.loadAsync to complete before using the font.`);
      } else {
        console.error(`fontFamily "${fontFamily}" is not a system font and has not been loaded through Font.loadAsync.\n
- If you intended to use a system font, make sure you typed the name correctly and that it is supported by your device operating system.\n
- If this is a custom font, be sure to load it with Font.loadAsync.`);
      }
    }
    return 'System';
  }
  return `ExpoFont-${(0, _FontLoader.getNativeFontName)(fontFamily)}`;
}
function isLoaded(fontFamily) {
  return fontFamily in loaded;
}
function isLoading(fontFamily) {
  return fontFamily in loadPromises;
}
function loadAsync(_x, _x2) {
  return _loadAsync.apply(this, arguments);
}
function _loadAsync() {
  _loadAsync = (0, _asyncToGenerator2.default)(function* (fontFamilyOrFontMap, source) {
    if (typeof fontFamilyOrFontMap === 'object') {
      if (source) {
        throw new _expoModulesCore.CodedError(`ERR_FONT_API`, `No fontFamily can be used for the provided source: ${source}. The second argument of \`loadAsync()\` can only be used with a \`string\` value as the first argument.`);
      }
      var fontMap = fontFamilyOrFontMap;
      var names = Object.keys(fontMap);
      yield Promise.all(names.map(function (name) {
        return loadFontInNamespaceAsync(name, fontMap[name]);
      }));
      return;
    }
    return yield loadFontInNamespaceAsync(fontFamilyOrFontMap, source);
  });
  return _loadAsync.apply(this, arguments);
}
function loadFontInNamespaceAsync(_x3, _x4) {
  return _loadFontInNamespaceAsync.apply(this, arguments);
}
function _loadFontInNamespaceAsync() {
  _loadFontInNamespaceAsync = (0, _asyncToGenerator2.default)(function* (fontFamily, source) {
    if (!source) {
      throw new _expoModulesCore.CodedError(`ERR_FONT_SOURCE`, `Cannot load null or undefined font source: { "${fontFamily}": ${source} }. Expected asset of type \`FontSource\` for fontFamily of name: "${fontFamily}"`);
    }
    if (loaded[fontFamily]) {
      return;
    }
    if (loadPromises.hasOwnProperty(fontFamily)) {
      return loadPromises[fontFamily];
    }
    var asset = (0, _FontLoader.getAssetForSource)(source);
    loadPromises[fontFamily] = (0, _asyncToGenerator2.default)(function* () {
      try {
        yield (0, _FontLoader.loadSingleFontAsync)(fontFamily, asset);
        loaded[fontFamily] = true;
      } finally {
        delete loadPromises[fontFamily];
      }
    })();
    yield loadPromises[fontFamily];
  });
  return _loadFontInNamespaceAsync.apply(this, arguments);
}
function unloadAllAsync() {
  return _unloadAllAsync.apply(this, arguments);
}
function _unloadAllAsync() {
  _unloadAllAsync = (0, _asyncToGenerator2.default)(function* () {
    if (!_ExpoFontLoader.default.unloadAllAsync) {
      throw new _expoModulesCore.UnavailabilityError('expo-font', 'unloadAllAsync');
    }
    if (Object.keys(loadPromises).length) {
      throw new _expoModulesCore.CodedError(`ERR_UNLOAD`, `Cannot unload fonts while they're still loading: ${Object.keys(loadPromises).join(', ')}`);
    }
    for (var fontFamily of Object.keys(loaded)) {
      delete loaded[fontFamily];
    }
    yield _ExpoFontLoader.default.unloadAllAsync();
  });
  return _unloadAllAsync.apply(this, arguments);
}
function unloadAsync(_x5, _x6) {
  return _unloadAsync.apply(this, arguments);
}
function _unloadAsync() {
  _unloadAsync = (0, _asyncToGenerator2.default)(function* (fontFamilyOrFontMap, options) {
    if (!_ExpoFontLoader.default.unloadAsync) {
      throw new _expoModulesCore.UnavailabilityError('expo-font', 'unloadAsync');
    }
    if (typeof fontFamilyOrFontMap === 'object') {
      if (options) {
        throw new _expoModulesCore.CodedError(`ERR_FONT_API`, `No fontFamily can be used for the provided options: ${options}. The second argument of \`unloadAsync()\` can only be used with a \`string\` value as the first argument.`);
      }
      var fontMap = fontFamilyOrFontMap;
      var names = Object.keys(fontMap);
      yield Promise.all(names.map(function (name) {
        return unloadFontInNamespaceAsync(name, fontMap[name]);
      }));
      return;
    }
    return yield unloadFontInNamespaceAsync(fontFamilyOrFontMap, options);
  });
  return _unloadAsync.apply(this, arguments);
}
function unloadFontInNamespaceAsync(_x7, _x8) {
  return _unloadFontInNamespaceAsync.apply(this, arguments);
}
function _unloadFontInNamespaceAsync() {
  _unloadFontInNamespaceAsync = (0, _asyncToGenerator2.default)(function* (fontFamily, options) {
    if (!loaded[fontFamily]) {
      return;
    } else {
      delete loaded[fontFamily];
    }
    var nativeFontName = (0, _FontLoader.getNativeFontName)(fontFamily);
    if (!nativeFontName) {
      throw new _expoModulesCore.CodedError(`ERR_FONT_FAMILY`, `Cannot unload an empty name`);
    }
    yield _ExpoFontLoader.default.unloadAsync(nativeFontName, options);
  });
  return _unloadFontInNamespaceAsync.apply(this, arguments);
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfZXhwb01vZHVsZXNDb3JlIiwicmVxdWlyZSIsIl9FeHBvRm9udExvYWRlciIsIl9pbnRlcm9wUmVxdWlyZURlZmF1bHQiLCJfRm9udCIsIl9Gb250TG9hZGVyIiwibG9hZGVkIiwibG9hZFByb21pc2VzIiwicHJvY2Vzc0ZvbnRGYW1pbHkiLCJmb250RmFtaWx5IiwiZm9udEZhbWlseU5lZWRzU2NvcGluZyIsImlzTG9hZGVkIiwiX19ERVZfXyIsImlzTG9hZGluZyIsImNvbnNvbGUiLCJlcnJvciIsImdldE5hdGl2ZUZvbnROYW1lIiwibG9hZEFzeW5jIiwiX3giLCJfeDIiLCJfbG9hZEFzeW5jIiwiYXBwbHkiLCJhcmd1bWVudHMiLCJfYXN5bmNUb0dlbmVyYXRvcjIiLCJkZWZhdWx0IiwiZm9udEZhbWlseU9yRm9udE1hcCIsInNvdXJjZSIsIkNvZGVkRXJyb3IiLCJmb250TWFwIiwibmFtZXMiLCJPYmplY3QiLCJrZXlzIiwiUHJvbWlzZSIsImFsbCIsIm1hcCIsIm5hbWUiLCJsb2FkRm9udEluTmFtZXNwYWNlQXN5bmMiLCJfeDMiLCJfeDQiLCJfbG9hZEZvbnRJbk5hbWVzcGFjZUFzeW5jIiwiaGFzT3duUHJvcGVydHkiLCJhc3NldCIsImdldEFzc2V0Rm9yU291cmNlIiwibG9hZFNpbmdsZUZvbnRBc3luYyIsInVubG9hZEFsbEFzeW5jIiwiX3VubG9hZEFsbEFzeW5jIiwiRXhwb0ZvbnRMb2FkZXIiLCJVbmF2YWlsYWJpbGl0eUVycm9yIiwibGVuZ3RoIiwiam9pbiIsInVubG9hZEFzeW5jIiwiX3g1IiwiX3g2IiwiX3VubG9hZEFzeW5jIiwib3B0aW9ucyIsInVubG9hZEZvbnRJbk5hbWVzcGFjZUFzeW5jIiwiX3g3IiwiX3g4IiwiX3VubG9hZEZvbnRJbk5hbWVzcGFjZUFzeW5jIiwibmF0aXZlRm9udE5hbWUiXSwic291cmNlcyI6WyIuLi9zcmMvRm9udC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBDb2RlZEVycm9yLCBVbmF2YWlsYWJpbGl0eUVycm9yIH0gZnJvbSAnZXhwby1tb2R1bGVzLWNvcmUnO1xuXG5pbXBvcnQgRXhwb0ZvbnRMb2FkZXIgZnJvbSAnLi9FeHBvRm9udExvYWRlcic7XG5pbXBvcnQgeyBGb250RGlzcGxheSwgRm9udFNvdXJjZSwgRm9udFJlc291cmNlLCBVbmxvYWRGb250T3B0aW9ucyB9IGZyb20gJy4vRm9udC50eXBlcyc7XG5pbXBvcnQge1xuICBnZXRBc3NldEZvclNvdXJjZSxcbiAgbG9hZFNpbmdsZUZvbnRBc3luYyxcbiAgZm9udEZhbWlseU5lZWRzU2NvcGluZyxcbiAgZ2V0TmF0aXZlRm9udE5hbWUsXG59IGZyb20gJy4vRm9udExvYWRlcic7XG5cbmNvbnN0IGxvYWRlZDogeyBbbmFtZTogc3RyaW5nXTogYm9vbGVhbiB9ID0ge307XG5jb25zdCBsb2FkUHJvbWlzZXM6IHsgW25hbWU6IHN0cmluZ106IFByb21pc2U8dm9pZD4gfSA9IHt9O1xuXG4vLyBAbmVlZHNBdWRpdFxuLy8gbm90ZShicmVudHZhdG5lKTogYXQgc29tZSBwb2ludCB3ZSBtYXkgd2FudCB0byB3YXJuIGlmIHRoaXMgaXMgY2FsbGVkIG91dHNpZGUgb2YgYSBtYW5hZ2VkIGFwcC5cbi8qKlxuICogVXNlZCB0byB0cmFuc2Zvcm0gZm9udCBmYW1pbHkgbmFtZXMgdG8gdGhlIHNjb3BlZCBuYW1lLiBUaGlzIGRvZXMgbm90IG5lZWQgdG9cbiAqIGJlIGNhbGxlZCBpbiBzdGFuZGFsb25lIG9yIGJhcmUgYXBwcyBidXQgaXQgd2lsbCByZXR1cm4gdW5zY29wZWQgZm9udCBmYW1pbHlcbiAqIG5hbWVzIGlmIGl0IGlzIGNhbGxlZCBpbiB0aG9zZSBjb250ZXh0cy5cbiAqXG4gKiBAcGFyYW0gZm9udEZhbWlseSBOYW1lIG9mIGZvbnQgdG8gcHJvY2Vzcy5cbiAqIEByZXR1cm5zIFJldHVybnMgYSBuYW1lIHByb2Nlc3NlZCBmb3IgdXNlIHdpdGggdGhlIFtjdXJyZW50IHdvcmtmbG93XShodHRwczovL2RvY3MuZXhwby5kZXYvYXJjaGl2ZS9tYW5hZ2VkLXZzLWJhcmUvKS5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHByb2Nlc3NGb250RmFtaWx5KGZvbnRGYW1pbHk6IHN0cmluZyB8IG51bGwpOiBzdHJpbmcgfCBudWxsIHtcbiAgaWYgKCFmb250RmFtaWx5IHx8ICFmb250RmFtaWx5TmVlZHNTY29waW5nKGZvbnRGYW1pbHkpKSB7XG4gICAgcmV0dXJuIGZvbnRGYW1pbHk7XG4gIH1cblxuICBpZiAoIWlzTG9hZGVkKGZvbnRGYW1pbHkpKSB7XG4gICAgaWYgKF9fREVWX18pIHtcbiAgICAgIGlmIChpc0xvYWRpbmcoZm9udEZhbWlseSkpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcihcbiAgICAgICAgICBgWW91IHN0YXJ0ZWQgbG9hZGluZyB0aGUgZm9udCBcIiR7Zm9udEZhbWlseX1cIiwgYnV0IHVzZWQgaXQgYmVmb3JlIGl0IGZpbmlzaGVkIGxvYWRpbmcuIFlvdSBuZWVkIHRvIHdhaXQgZm9yIEZvbnQubG9hZEFzeW5jIHRvIGNvbXBsZXRlIGJlZm9yZSB1c2luZyB0aGUgZm9udC5gXG4gICAgICAgICk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBjb25zb2xlLmVycm9yKFxuICAgICAgICAgIGBmb250RmFtaWx5IFwiJHtmb250RmFtaWx5fVwiIGlzIG5vdCBhIHN5c3RlbSBmb250IGFuZCBoYXMgbm90IGJlZW4gbG9hZGVkIHRocm91Z2ggRm9udC5sb2FkQXN5bmMuXFxuXG4tIElmIHlvdSBpbnRlbmRlZCB0byB1c2UgYSBzeXN0ZW0gZm9udCwgbWFrZSBzdXJlIHlvdSB0eXBlZCB0aGUgbmFtZSBjb3JyZWN0bHkgYW5kIHRoYXQgaXQgaXMgc3VwcG9ydGVkIGJ5IHlvdXIgZGV2aWNlIG9wZXJhdGluZyBzeXN0ZW0uXFxuXG4tIElmIHRoaXMgaXMgYSBjdXN0b20gZm9udCwgYmUgc3VyZSB0byBsb2FkIGl0IHdpdGggRm9udC5sb2FkQXN5bmMuYFxuICAgICAgICApO1xuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiAnU3lzdGVtJztcbiAgfVxuXG4gIHJldHVybiBgRXhwb0ZvbnQtJHtnZXROYXRpdmVGb250TmFtZShmb250RmFtaWx5KX1gO1xufVxuXG4vLyBAbmVlZHNBdWRpdFxuLyoqXG4gKiBTeW5jaHJvbm91c2x5IGRldGVjdCBpZiB0aGUgZm9udCBmb3IgYGZvbnRGYW1pbHlgIGhhcyBmaW5pc2hlZCBsb2FkaW5nLlxuICpcbiAqIEBwYXJhbSBmb250RmFtaWx5IFRoZSBuYW1lIHVzZWQgdG8gbG9hZCB0aGUgYEZvbnRSZXNvdXJjZWAuXG4gKiBAcmV0dXJuIFJldHVybnMgYHRydWVgIGlmIHRoZSBmb250IGhhcyBmdWxseSBsb2FkZWQuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBpc0xvYWRlZChmb250RmFtaWx5OiBzdHJpbmcpOiBib29sZWFuIHtcbiAgcmV0dXJuIGZvbnRGYW1pbHkgaW4gbG9hZGVkO1xufVxuXG4vLyBAbmVlZHNBdWRpdFxuLyoqXG4gKiBTeW5jaHJvbm91c2x5IGRldGVjdCBpZiB0aGUgZm9udCBmb3IgYGZvbnRGYW1pbHlgIGlzIHN0aWxsIGJlaW5nIGxvYWRlZC5cbiAqXG4gKiBAcGFyYW0gZm9udEZhbWlseSBUaGUgbmFtZSB1c2VkIHRvIGxvYWQgdGhlIGBGb250UmVzb3VyY2VgLlxuICogQHJldHVybnMgUmV0dXJucyBgdHJ1ZWAgaWYgdGhlIGZvbnQgaXMgc3RpbGwgbG9hZGluZy5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGlzTG9hZGluZyhmb250RmFtaWx5OiBzdHJpbmcpOiBib29sZWFuIHtcbiAgcmV0dXJuIGZvbnRGYW1pbHkgaW4gbG9hZFByb21pc2VzO1xufVxuXG4vLyBAbmVlZHNBdWRpdFxuLyoqXG4gKiBIaWdobHkgZWZmaWNpZW50IG1ldGhvZCBmb3IgbG9hZGluZyBmb250cyBmcm9tIHN0YXRpYyBvciByZW1vdGUgcmVzb3VyY2VzIHdoaWNoIGNhbiB0aGVuIGJlIHVzZWRcbiAqIHdpdGggdGhlIHBsYXRmb3JtJ3MgbmF0aXZlIHRleHQgZWxlbWVudHMuIEluIHRoZSBicm93c2VyIHRoaXMgZ2VuZXJhdGVzIGEgYEBmb250LWZhY2VgIGJsb2NrIGluXG4gKiBhIHNoYXJlZCBzdHlsZSBzaGVldCBmb3IgZm9udHMuIE5vIENTUyBpcyBuZWVkZWQgdG8gdXNlIHRoaXMgbWV0aG9kLlxuICpcbiAqIEBwYXJhbSBmb250RmFtaWx5T3JGb250TWFwIHN0cmluZyBvciBtYXAgb2YgdmFsdWVzIHRoYXQgY2FuIGJlIHVzZWQgYXMgdGhlIFtgZm9udEZhbWlseWBdKGh0dHBzOi8vcmVhY3RuYXRpdmUuZGV2L2RvY3MvdGV4dCNzdHlsZSlcbiAqIHN0eWxlIHByb3Agd2l0aCBSZWFjdCBOYXRpdmUgVGV4dCBlbGVtZW50cy5cbiAqIEBwYXJhbSBzb3VyY2UgdGhlIGZvbnQgYXNzZXQgdGhhdCBzaG91bGQgYmUgbG9hZGVkIGludG8gdGhlIGBmb250RmFtaWx5YCBuYW1lc3BhY2UuXG4gKlxuICogQHJldHVybiBSZXR1cm5zIGEgcHJvbWlzZSB0aGF0IGZ1bGZpbHMgd2hlbiB0aGUgZm9udCBoYXMgbG9hZGVkLiBPZnRlbiB5b3UgbWF5IHdhbnQgdG8gd3JhcCB0aGVcbiAqIG1ldGhvZCBpbiBhIGB0cnkvY2F0Y2gvZmluYWxseWAgdG8gZW5zdXJlIHRoZSBhcHAgY29udGludWVzIGlmIHRoZSBmb250IGZhaWxzIHRvIGxvYWQuXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBsb2FkQXN5bmMoXG4gIGZvbnRGYW1pbHlPckZvbnRNYXA6IHN0cmluZyB8IFJlY29yZDxzdHJpbmcsIEZvbnRTb3VyY2U+LFxuICBzb3VyY2U/OiBGb250U291cmNlXG4pOiBQcm9taXNlPHZvaWQ+IHtcbiAgaWYgKHR5cGVvZiBmb250RmFtaWx5T3JGb250TWFwID09PSAnb2JqZWN0Jykge1xuICAgIGlmIChzb3VyY2UpIHtcbiAgICAgIHRocm93IG5ldyBDb2RlZEVycm9yKFxuICAgICAgICBgRVJSX0ZPTlRfQVBJYCxcbiAgICAgICAgYE5vIGZvbnRGYW1pbHkgY2FuIGJlIHVzZWQgZm9yIHRoZSBwcm92aWRlZCBzb3VyY2U6ICR7c291cmNlfS4gVGhlIHNlY29uZCBhcmd1bWVudCBvZiBcXGBsb2FkQXN5bmMoKVxcYCBjYW4gb25seSBiZSB1c2VkIHdpdGggYSBcXGBzdHJpbmdcXGAgdmFsdWUgYXMgdGhlIGZpcnN0IGFyZ3VtZW50LmBcbiAgICAgICk7XG4gICAgfVxuICAgIGNvbnN0IGZvbnRNYXAgPSBmb250RmFtaWx5T3JGb250TWFwO1xuICAgIGNvbnN0IG5hbWVzID0gT2JqZWN0LmtleXMoZm9udE1hcCk7XG4gICAgYXdhaXQgUHJvbWlzZS5hbGwobmFtZXMubWFwKChuYW1lKSA9PiBsb2FkRm9udEluTmFtZXNwYWNlQXN5bmMobmFtZSwgZm9udE1hcFtuYW1lXSkpKTtcbiAgICByZXR1cm47XG4gIH1cblxuICByZXR1cm4gYXdhaXQgbG9hZEZvbnRJbk5hbWVzcGFjZUFzeW5jKGZvbnRGYW1pbHlPckZvbnRNYXAsIHNvdXJjZSk7XG59XG5cbmFzeW5jIGZ1bmN0aW9uIGxvYWRGb250SW5OYW1lc3BhY2VBc3luYyhcbiAgZm9udEZhbWlseTogc3RyaW5nLFxuICBzb3VyY2U/OiBGb250U291cmNlIHwgbnVsbFxuKTogUHJvbWlzZTx2b2lkPiB7XG4gIGlmICghc291cmNlKSB7XG4gICAgdGhyb3cgbmV3IENvZGVkRXJyb3IoXG4gICAgICBgRVJSX0ZPTlRfU09VUkNFYCxcbiAgICAgIGBDYW5ub3QgbG9hZCBudWxsIG9yIHVuZGVmaW5lZCBmb250IHNvdXJjZTogeyBcIiR7Zm9udEZhbWlseX1cIjogJHtzb3VyY2V9IH0uIEV4cGVjdGVkIGFzc2V0IG9mIHR5cGUgXFxgRm9udFNvdXJjZVxcYCBmb3IgZm9udEZhbWlseSBvZiBuYW1lOiBcIiR7Zm9udEZhbWlseX1cImBcbiAgICApO1xuICB9XG5cbiAgaWYgKGxvYWRlZFtmb250RmFtaWx5XSkge1xuICAgIHJldHVybjtcbiAgfVxuXG4gIGlmIChsb2FkUHJvbWlzZXMuaGFzT3duUHJvcGVydHkoZm9udEZhbWlseSkpIHtcbiAgICByZXR1cm4gbG9hZFByb21pc2VzW2ZvbnRGYW1pbHldO1xuICB9XG5cbiAgLy8gSW1wb3J0YW50OiB3ZSB3YW50IGFsbCBjYWxsZXJzIHRoYXQgY29uY3VycmVudGx5IHRyeSB0byBsb2FkIHRoZSBzYW1lIGZvbnQgdG8gYXdhaXQgdGhlIHNhbWVcbiAgLy8gcHJvbWlzZS4gSWYgd2UncmUgaGVyZSwgd2UgaGF2ZW4ndCBjcmVhdGVkIHRoZSBwcm9taXNlIHlldC4gVG8gZW5zdXJlIHdlIGNyZWF0ZSBvbmx5IG9uZVxuICAvLyBwcm9taXNlIGluIHRoZSBwcm9ncmFtLCB3ZSBuZWVkIHRvIGNyZWF0ZSB0aGUgcHJvbWlzZSBzeW5jaHJvbm91c2x5IHdpdGhvdXQgeWllbGRpbmcgdGhlIGV2ZW50XG4gIC8vIGxvb3AgZnJvbSB0aGlzIHBvaW50LlxuXG4gIGNvbnN0IGFzc2V0ID0gZ2V0QXNzZXRGb3JTb3VyY2Uoc291cmNlKTtcbiAgbG9hZFByb21pc2VzW2ZvbnRGYW1pbHldID0gKGFzeW5jICgpID0+IHtcbiAgICB0cnkge1xuICAgICAgYXdhaXQgbG9hZFNpbmdsZUZvbnRBc3luYyhmb250RmFtaWx5LCBhc3NldCk7XG4gICAgICBsb2FkZWRbZm9udEZhbWlseV0gPSB0cnVlO1xuICAgIH0gZmluYWxseSB7XG4gICAgICBkZWxldGUgbG9hZFByb21pc2VzW2ZvbnRGYW1pbHldO1xuICAgIH1cbiAgfSkoKTtcblxuICBhd2FpdCBsb2FkUHJvbWlzZXNbZm9udEZhbWlseV07XG59XG5cbi8vIEBuZWVkc0F1ZGl0XG4vKipcbiAqIFVubG9hZHMgYWxsIHRoZSBjdXN0b20gZm9udHMuIFRoaXMgaXMgdXNlZCBmb3IgdGVzdGluZy5cbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVubG9hZEFsbEFzeW5jKCk6IFByb21pc2U8dm9pZD4ge1xuICBpZiAoIUV4cG9Gb250TG9hZGVyLnVubG9hZEFsbEFzeW5jKSB7XG4gICAgdGhyb3cgbmV3IFVuYXZhaWxhYmlsaXR5RXJyb3IoJ2V4cG8tZm9udCcsICd1bmxvYWRBbGxBc3luYycpO1xuICB9XG5cbiAgaWYgKE9iamVjdC5rZXlzKGxvYWRQcm9taXNlcykubGVuZ3RoKSB7XG4gICAgdGhyb3cgbmV3IENvZGVkRXJyb3IoXG4gICAgICBgRVJSX1VOTE9BRGAsXG4gICAgICBgQ2Fubm90IHVubG9hZCBmb250cyB3aGlsZSB0aGV5J3JlIHN0aWxsIGxvYWRpbmc6ICR7T2JqZWN0LmtleXMobG9hZFByb21pc2VzKS5qb2luKCcsICcpfWBcbiAgICApO1xuICB9XG5cbiAgZm9yIChjb25zdCBmb250RmFtaWx5IG9mIE9iamVjdC5rZXlzKGxvYWRlZCkpIHtcbiAgICBkZWxldGUgbG9hZGVkW2ZvbnRGYW1pbHldO1xuICB9XG5cbiAgYXdhaXQgRXhwb0ZvbnRMb2FkZXIudW5sb2FkQWxsQXN5bmMoKTtcbn1cblxuLy8gQG5lZWRzQXVkaXRcbi8qKlxuICogVW5sb2FkIGN1c3RvbSBmb250cyBtYXRjaGluZyB0aGUgYGZvbnRGYW1pbHlgcyBhbmQgZGlzcGxheSB2YWx1ZXMgcHJvdmlkZWQuXG4gKiBCZWNhdXNlIGZvbnRzIGFyZSBhdXRvbWF0aWNhbGx5IHVubG9hZGVkIG9uIGV2ZXJ5IHBsYXRmb3JtIHRoaXMgaXMgbW9zdGx5IHVzZWQgZm9yIHRlc3RpbmcuXG4gKlxuICogQHBhcmFtIGZvbnRGYW1pbHlPckZvbnRNYXAgVGhlIG5hbWUgb3IgbmFtZXMgb2YgdGhlIGN1c3RvbSBmb250cyB0aGF0IHdpbGwgYmUgdW5sb2FkZWQuXG4gKiBAcGFyYW0gb3B0aW9ucyBXaGVuIGBmb250RmFtaWx5T3JGb250TWFwYCBpcyBhIHN0cmluZywgdGhpcyBzaG91bGQgYmUgdGhlIGZvbnQgc291cmNlIHVzZWQgdG8gbG9hZFxuICogdGhlIGN1c3RvbSBmb250IG9yaWdpbmFsbHkuXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB1bmxvYWRBc3luYyhcbiAgZm9udEZhbWlseU9yRm9udE1hcDogc3RyaW5nIHwgUmVjb3JkPHN0cmluZywgVW5sb2FkRm9udE9wdGlvbnM+LFxuICBvcHRpb25zPzogVW5sb2FkRm9udE9wdGlvbnNcbik6IFByb21pc2U8dm9pZD4ge1xuICBpZiAoIUV4cG9Gb250TG9hZGVyLnVubG9hZEFzeW5jKSB7XG4gICAgdGhyb3cgbmV3IFVuYXZhaWxhYmlsaXR5RXJyb3IoJ2V4cG8tZm9udCcsICd1bmxvYWRBc3luYycpO1xuICB9XG4gIGlmICh0eXBlb2YgZm9udEZhbWlseU9yRm9udE1hcCA9PT0gJ29iamVjdCcpIHtcbiAgICBpZiAob3B0aW9ucykge1xuICAgICAgdGhyb3cgbmV3IENvZGVkRXJyb3IoXG4gICAgICAgIGBFUlJfRk9OVF9BUElgLFxuICAgICAgICBgTm8gZm9udEZhbWlseSBjYW4gYmUgdXNlZCBmb3IgdGhlIHByb3ZpZGVkIG9wdGlvbnM6ICR7b3B0aW9uc30uIFRoZSBzZWNvbmQgYXJndW1lbnQgb2YgXFxgdW5sb2FkQXN5bmMoKVxcYCBjYW4gb25seSBiZSB1c2VkIHdpdGggYSBcXGBzdHJpbmdcXGAgdmFsdWUgYXMgdGhlIGZpcnN0IGFyZ3VtZW50LmBcbiAgICAgICk7XG4gICAgfVxuICAgIGNvbnN0IGZvbnRNYXAgPSBmb250RmFtaWx5T3JGb250TWFwO1xuICAgIGNvbnN0IG5hbWVzID0gT2JqZWN0LmtleXMoZm9udE1hcCk7XG4gICAgYXdhaXQgUHJvbWlzZS5hbGwobmFtZXMubWFwKChuYW1lKSA9PiB1bmxvYWRGb250SW5OYW1lc3BhY2VBc3luYyhuYW1lLCBmb250TWFwW25hbWVdKSkpO1xuICAgIHJldHVybjtcbiAgfVxuXG4gIHJldHVybiBhd2FpdCB1bmxvYWRGb250SW5OYW1lc3BhY2VBc3luYyhmb250RmFtaWx5T3JGb250TWFwLCBvcHRpb25zKTtcbn1cblxuYXN5bmMgZnVuY3Rpb24gdW5sb2FkRm9udEluTmFtZXNwYWNlQXN5bmMoXG4gIGZvbnRGYW1pbHk6IHN0cmluZyxcbiAgb3B0aW9ucz86IFVubG9hZEZvbnRPcHRpb25zIHwgbnVsbFxuKTogUHJvbWlzZTx2b2lkPiB7XG4gIGlmICghbG9hZGVkW2ZvbnRGYW1pbHldKSB7XG4gICAgcmV0dXJuO1xuICB9IGVsc2Uge1xuICAgIGRlbGV0ZSBsb2FkZWRbZm9udEZhbWlseV07XG4gIH1cblxuICAvLyBJbXBvcnRhbnQ6IHdlIHdhbnQgYWxsIGNhbGxlcnMgdGhhdCBjb25jdXJyZW50bHkgdHJ5IHRvIGxvYWQgdGhlIHNhbWUgZm9udCB0byBhd2FpdCB0aGUgc2FtZVxuICAvLyBwcm9taXNlLiBJZiB3ZSdyZSBoZXJlLCB3ZSBoYXZlbid0IGNyZWF0ZWQgdGhlIHByb21pc2UgeWV0LiBUbyBlbnN1cmUgd2UgY3JlYXRlIG9ubHkgb25lXG4gIC8vIHByb21pc2UgaW4gdGhlIHByb2dyYW0sIHdlIG5lZWQgdG8gY3JlYXRlIHRoZSBwcm9taXNlIHN5bmNocm9ub3VzbHkgd2l0aG91dCB5aWVsZGluZyB0aGUgZXZlbnRcbiAgLy8gbG9vcCBmcm9tIHRoaXMgcG9pbnQuXG5cbiAgY29uc3QgbmF0aXZlRm9udE5hbWUgPSBnZXROYXRpdmVGb250TmFtZShmb250RmFtaWx5KTtcblxuICBpZiAoIW5hdGl2ZUZvbnROYW1lKSB7XG4gICAgdGhyb3cgbmV3IENvZGVkRXJyb3IoYEVSUl9GT05UX0ZBTUlMWWAsIGBDYW5ub3QgdW5sb2FkIGFuIGVtcHR5IG5hbWVgKTtcbiAgfVxuXG4gIGF3YWl0IEV4cG9Gb250TG9hZGVyLnVubG9hZEFzeW5jKG5hdGl2ZUZvbnROYW1lLCBvcHRpb25zKTtcbn1cblxuZXhwb3J0IHsgRm9udERpc3BsYXksIEZvbnRTb3VyY2UsIEZvbnRSZXNvdXJjZSwgVW5sb2FkRm9udE9wdGlvbnMgfTtcbiJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQSxJQUFBQSxnQkFBQSxHQUFBQyxPQUFBO0FBRUEsSUFBQUMsZUFBQSxHQUFBQyxzQkFBQSxDQUFBRixPQUFBO0FBQ0EsSUFBQUcsS0FBQSxHQUFBSCxPQUFBO0FBQ0EsSUFBQUksV0FBQSxHQUFBSixPQUFBO0FBT0EsSUFBTUssTUFBTSxHQUFnQyxFQUFF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